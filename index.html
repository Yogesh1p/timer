<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Your head content here -->
</head>
<body>
    <!-- Your existing HTML content -->

    <div class="container">
        <!-- ... Your timer and other content ... -->
        <button id="startButton">Start Timer</button>
        <button id="pauseButton">Pause Timer</button>
    </div>

    <!-- JavaScript code to handle the timer and export -->
    <script>
        let timerInterval;
        let isPaused = false;
        let lastSessionTime = null;
        let sessionHistory = [];

        // Function to update the session history
        function updateSessionHistory() {
            if (lastSessionTime) {
                const duration = calculateDuration();
                const sessionText = `Session: ${lastSessionTime}, Duration: ${duration}`;
                sessionHistory.push(sessionText);
            }
        }

        // Function to export session history as an Excel file
        function exportSessionHistory() {
            // Create an array of objects from the session history
            const sessionData = sessionHistory.map(session => {
                const [sessionTime, sessionDuration] = session.split(', ');
                return { 'Session Time': sessionTime, 'Duration': sessionDuration };
            });

            // Create a workbook and worksheet
            const workbook = new ExcelJS.Workbook();
            const worksheet = workbook.addWorksheet('Session History');
            worksheet.columns = [{ header: 'Session Time', key: 'Session Time', width: 20 }, { header: 'Duration', key: 'Duration', width: 15 }];

            // Add session data to the worksheet
            sessionData.forEach(data => {
                worksheet.addRow(data);
            });

            // Generate the Excel file and trigger the download
            workbook.xlsx.writeBuffer().then(buffer => {
                const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'session_history.xlsx';
                a.click();
                URL.revokeObjectURL(url);
            });
        }

        document.getElementById('startButton').addEventListener('click', function() {
            if (isPaused) {
                isPaused = false;
                startTimer();
            }
        });

        document.getElementById('pauseButton').addEventListener('click', function() {
            if (!isPaused) {
                isPaused = true;
                clearInterval(timerInterval);
                updateSessionHistory();
                exportSessionHistory(); // Export session history when pause is clicked
            }
        });

        // Your timer and other timer-related code here...

        // Function to calculate session duration
        function calculateDuration() {
            // ... Your existing code for duration calculation ...
        }
    </script>
</body>
</html>
